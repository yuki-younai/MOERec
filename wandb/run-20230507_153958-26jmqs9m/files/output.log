loadding data
reading category information






100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 136710/136710 [00:15<00:00, 8768.06it/s]
reading train data



100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2571752/2571752 [00:06<00:00, 424633.82it/s]
reading valid data

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 845781/845781 [00:02<00:00, 409451.62it/s]
reading test data
get weight for each sample
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 136710/136710 [00:00<00:00, 2034752.04it/s]
train loss = 1.2836737632751465
loss: 1.4166042804718018, Performance is better... saving the model
train loss = 1.1551966667175293
loss: 1.330534815788269, Performance is better... saving the model
Starting new HTTPS connection (1): o151352.ingest.sentry.io:443
https://o151352.ingest.sentry.io:443 "POST /api/5288891/envelope/ HTTP/1.1" 200 2
train loss = 1.0382192134857178
loss: 1.2565948963165283, Performance is better... saving the model
train loss = 0.9471313953399658
loss: 1.2088470458984375, Performance is better... saving the model
train loss = 0.8830743432044983
loss: 1.1642988920211792, Performance is better... saving the model
train loss = 0.8294224143028259
loss: 1.1269761323928833, Performance is better... saving the model
train loss = 0.7834901213645935
loss: 1.097558617591858, Performance is better... saving the model
train loss = 0.7443091869354248
loss: 1.0625542402267456, Performance is better... saving the model
train loss = 0.7107830047607422
loss: 1.039257526397705, Performance is better... saving the model
train loss = 0.6797485947608948
loss: 1.0141079425811768, Performance is better... saving the model
train loss = 0.6532271504402161
loss: 0.987419068813324, Performance is better... saving the model
train loss = 0.6294015049934387
loss: 0.9662513732910156, Performance is better... saving the model
train loss = 0.6064475178718567
loss: 0.945166289806366, Performance is better... saving the model
train loss = 0.5859953165054321
loss: 0.9276164174079895, Performance is better... saving the model
train loss = 0.5677312612533569
loss: 0.9107682704925537, Performance is better... saving the model
train loss = 0.5503549575805664
loss: 0.897239625453949, Performance is better... saving the model
train loss = 0.5342019200325012
loss: 0.8854778409004211, Performance is better... saving the model
train loss = 0.5196050405502319
loss: 0.8724774122238159, Performance is better... saving the model
train loss = 0.5057026743888855
loss: 0.8620472550392151, Performance is better... saving the model
train loss = 0.49320894479751587











100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 41/41 [00:28<00:00,  1.42it/s]
For top100, metric recall = 0.009041188145922568
For top300, metric recall = 0.017612857798824898
For top100, metric hit_ratio = 0.07958079701814046
For top300, metric hit_ratio = 0.14503890697421126
For top100, metric coverage = 51.9625694335193
For top300, metric coverage = 116.27980346834799
Traceback (most recent call last):
  File "main.py", line 84, in <module>
    wandb.log({"recall_100":res[0],"hit_ratio_100":res[1],"coverage_100":res[2],racall_300:res[3],"hit_ratio_300":res[4],"coverage_300":res[5],"loss":loss_val})
NameError: name 'racall_300' is not defined