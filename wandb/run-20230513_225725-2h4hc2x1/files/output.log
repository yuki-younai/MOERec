loadding data
reading category information





100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 136710/136710 [00:13<00:00, 10001.83it/s]
reading train data



100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2571752/2571752 [00:05<00:00, 432691.75it/s]
reading valid data
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 845781/845781 [00:01<00:00, 424366.21it/s]
reading test data
model already setting
get weight for each sample
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 136710/136710 [00:00<00:00, 2569391.08it/s]
Traceback (most recent call last):
  File "main.py", line 64, in <module>
    loss_train += (weight * loss.squeeze(1)).mean()+0.2*loss_moe
RuntimeError: output with shape [1] doesn't match the broadcast shape [0]